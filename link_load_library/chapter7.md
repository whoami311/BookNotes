# 动态链接

## 地址无关代码

把指令中那些需要被修改的部分分离出来，跟数据部分放在一起，这样指令部分就可以保持不变，而数据部分可以在每个进程中拥有一个副本。这种方案就是目前被称为**地址无关代码（PIC，Position-independent Code）**的技术。

## 动态链接的步骤和实现

动态链接基本上分为 3 步：先是启动动态链接器本身，然后装载所有需要的共享对象，最后是重定位和初始化。

一个共享对象里面的全局符号被另一个共享对象的同名全局符号覆盖的现象又被称为共享对象**全局符号介入（Global Symbol Interpose）**。

关于全局符号介入这个问题，实际上 Linux 下的动态链接器是这样处理的：它定义了一个规则，那就是**当一个符号需要被加入全局符号表时，如果相同的符号名已经存在，则后加入的符号被忽略**。

## 显式运行时链接

动态库的装载时通过一系列由动态链接器提供的 API，具体地讲共有 4 个函数：打开动态库（`dlopen`）、查找符号（`dlsym`）、错误处理（`dlerror`）以及关闭动态库（`dlclose`），程序可以通过这几个 API 对动态库进行操作。
