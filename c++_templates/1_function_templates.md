# 函数模板

- `max()` 模板根据 [StepanovNotes] 有意返回 `b < a ? a : b` 而不是 `a < b ? b : a`，以确保即使两个不同对象的值相等但不相同，函数也能正确执行。

```c++
template <typename T>
T max(T a, T b) {
    return b < a ? a : b;
}
```

- 如果生成的代码有效，`void` 就是有效的模板实参。

```c++
template <typename T>
T foo(T*) {}

void* vp = nullptr;
foo(vp);            // 正确，推导为 void foo(void*)
```

- 模板分两个阶段“编译”。
    1. 定义期间不会实例化，可以忽略模板参数，只检查模板代码自身的正确性。这包含以下几个方面。
        - 发现语法错误，比如少了分号。
        - 发现使用独立于模板参数的未知名称（类型名、函数名等）。
        - 检查独立于模板参数的静态断言。
    2. 实例化期间会再次检查模板代码以确保所有代码的有效性。也就是说在当前阶段会复查所有依赖于模板参数的部分。